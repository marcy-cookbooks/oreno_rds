[mysqld]
datadir=<%= @datadir %>
socket=<%= @socket %>

server_id=<%= @server_id %>
log-bin=mysql-bin
log-slave-updates
gtid-mode=ON
enforce-gtid-consistency
master_info_repository=TABLE
relay_log_info_repository=TABLE
report_host=<%= @report_host %>

<% if @server_type == 'master' %>
plugin-load=rpl_semi_sync_master=semisync_master.so
rpl_semi_sync_master_enabled = 1
<% elsif @server_type == 'standby' %>
plugin-load=rpl_semi_sync_slave=semisync_slave.so
rpl_semi_sync_slave_enabled = 1
<% else @server_type == 'slave' %>
rpl_semi_sync_slave_enabled = 0
<% end %>

!includedir /etc/mysql.d

[mysqld_safe]
log-error=<%= @log_error %>
pid-file=<%= @pid_file %>
